<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<meta name="description" content="">
		<meta name="author" content="">
		<link rel="shortcut icon" href="img/favicon.ico" type="image/x-icon" />
		<title>Sturgeon Simulator</title>

		<!-- Bootstrap -->
		<link href="css/bootstrap.min.css" rel="stylesheet">

		<!-- Bootstrap theme -->
		<link href="css/bootstrap-theme.min.css" rel="stylesheet">

		<!-- jQuery UI -->
		<link href="css/jquery-ui.min.css" rel="stylesheet">
		<!--<link href="css/jquery-ui.structure.min.css" rel="stylesheet">-->
		<!--<link href="css/jquery-ui.theme.min.css" rel="stylesheet">-->

		<!-- Select2 -->
		<link href="css/select2.min.css" rel="stylesheet">

		<!-- jQuery Growl -->
		<link href="css/jquery.growl.css" rel="stylesheet">

		<!-- Theme customizations -->
		<link href="css/custom.css" rel="stylesheet">

		<!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
		<!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
		<!--[if lt IE 9]>
		  <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
		  <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
		<![endif]-->
	</head>

	<body>
		<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
		  <div class="modal-dialog">

		    <div class="modal-content massupdate">
			    <div class="modal-header">
			        <button type="button" class="close" data-bind="click: hideModal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
			        <h4 class="modal-title">Error</h4>
			    </div>
				<div class="modal-body">
				</div>
				<div class="modal-footer">
				</div>
		    </div>

		  </div>
		</div>

		<div class="container">

			<div class="loading-indicator hidden" data-bind="visible: showLoading(), css: { hidden: false }" ><img src="img/ajax-loader.gif" /></div>

			<!-- start main header area -->
			<div class="header-area">

				<!-- start title + load/save -->
				<div class="row title-row">
					<div class="col-md-9 no-left-padding"><h2 class="title">Sturgeon Simulator</h2></div>
					<div class="col-md-1 no-right-padding"><span class="saved-notice hidden">Saved!</span></div>
					<div class="col-md-1"><button type="button" class="btn btn-default" data-bind="click: loadGame">Load</button></div>
					<div class="col-md-1 no-right-padding"><button type="button" class="btn btn-default" data-bind="click: saveGame">Save</button></div>
				</div>
				<!-- end title + load/save -->

				<!-- start stat row header row -->
				<div class="row player-stat-row player-stats hidden">
					<div class="col-md-1 with-left-padding"><span class="stat-label">Level</span><span class="stat-value" data-bind="text: player().level()"></span></div>
					<div class="col-md-1"><span class="stat-label">HP</span><span class="stat-value" data-bind="text: player().hp() + '/' + player().maxHp()"></span></div>
					<div class="col-md-1"><span class="stat-label">AC</span><span class="stat-value" data-bind="text: player().totalArmor()"></span></div>
					<div class="col-md-1"><span class="stat-label">DMG</span><span class="stat-value" data-bind="text: player().minDmg() + ' - ' + player().maxDmg()"></span></div>
					<div class="col-md-1"><span class="stat-label">STR</span><span class="stat-value" data-bind="text: player().str()"></span></div>
					<div class="col-md-1"><span class="stat-label">DEX</span><span class="stat-value" data-bind="text: player().dex()"></span></div>
					<div class="col-md-1"><span class="stat-label">END</span><span class="stat-value" data-bind="text: player().end()"></span></div>
					<div class="col-md-1"><span class="stat-label">SPD</span><span class="stat-value" data-bind="text: player().speed()"></span></div>


					<div class="col-md-1"><span class="stat-label"></span><span class="stat-value"></span></div>
					<div class="col-md-1"><span class="stat-label"></span><span class="stat-value"></span></div>


					<div class="col-md-1"><span class="stat-label">EXP</span><span class="stat-value" data-bind="text: player().exp() + '/' + player().expRequiredForNextLevel()"></span></div>
					<div class="col-md-1 with-right-padding"><span class="stat-label">GP</span><span class="stat-value" data-bind="text: player().gp()"></span></div>
				</div>
				<!-- end stat row header row -->

			</div>
			<!-- end main header area -->

			<!-- start main content area -->
			<div class="content-area">

				<!-- start main row -->
				<div class="main-content-row row hidden">

					<!-- start leftcol -->
					<div class="col-md-4 leftcol">

						<div class="leftcol-inner">

							<!-- start player control area -->
							<div class="player-controls" data-bind="css: { hidden: leftColContent() != 'player_controls' }">

								<div class="state-controls">
									<div class="state-button-col">
										<div class="state-button-row">
											<h3>Abilities</h3>
										</div>
										<div class="state-button-row">
											<div class="state-button">
												<button type="button" class="btn btn-default" data-bind="
													click: playerActions.findFood,
													text: 'Scrounge for food' + ( player().skillCooldowns().findFood() ? ' (' + player().skillCooldowns().findFood() + ')' : '' ),
													css: { disabled : player().skillCooldowns().findFood() > 0 }">
												</button>
											</div>
										</div>
										<div class="state-button-row">
											<div class="state-button">
												<button type="button" class="btn btn-default" data-bind="
													click: playerActions.scanSquares,
													text: 'Scan surroundings' + ( player().skillCooldowns().scanSquares() ? ' (' + player().skillCooldowns().scanSquares() + ')' : '' ),
													css: { disabled : player().skillCooldowns().scanSquares() > 0 }">
												</button>
											</div>
										</div>
									</div>
									<div class="state-button-col with-left-padding">
										<div class="state-button-row">
											<h3>Other Actions</h3>
										</div>
										<div class="state-button-row">
											<div class="state-button">
												<button type="button" class="btn btn-default" data-bind="
													click: toggleInventory,
													text: 'Check Inventory' + ' (' + player().inventorySlotsOccupied() + '/' + player().inventoryMaxSlots() + ')'">
												</button>
											</div>
										</div>
										<div class="state-button-row">
											<div class="state-button">
												<button type="button" class="btn btn-default" data-bind="
													css: { disabled: foodAvailableForQuickEat() == 0 },
													click: quickEatFood,
													text: 'Eat Food (poorest first)'">
												</button>
											</div>
										</div>
									</div>
									<div class="clear"></div>
									<div class="state-button-col full-width player-skills">
										<div class="state-button-row">
											<h3>Skill Proficiencies</h3>
										</div>
										<div class="state-button-row">
											<span class="stat">Find Food:</span>
											<span class="value" data-bind="text: $root.player().skills().findFood()"></span>
										</div>
										<div class="state-button-row">
											<span class="stat">Scan Range:</span>
											<span class="value" data-bind="text: $root.player().skills().scanSquares()"></span>
										</div>
									</div>
									<div class="clear"></div>
								</div>
								
							</div>
							<!-- end player control area -->

							<!-- start inventory area -->
							<div class="inventory" data-bind="css: { hidden: leftColContent() != 'inventory' }">
								
								<h3>Inventory (<span data-bind="css: { danger: player().inventorySlotsOccupied() > player().inventoryMaxSlots() }, text: player().inventorySlotsOccupied()"></span>/<span data-bind="text: player().inventoryMaxSlots()"></span> slots occupied)</h3>

								<div class="lines">
									<!-- ko if: $root.player().inventory.items().length == 0 || ($root.player().inventory.items().length == 1 && $root.player().gp() > 0) -->
									<div class="line empty">
										<span class="item">Your inventory is empty</span>
									</div>
									<!-- /ko -->
									<!-- ko foreach: $root.player().inventory.items() -->
									<div class="line" data-bind="click: $root.setInventoryItemAsActiveItem, css: { selected: $root._shouldItemBeSelected($data), hidden : $data.id == 'gold' }">
										<span class="item" data-bind="text: $data.name"></span>
										<span class="qty" data-bind="text: $data.qty()"></span>
									</div>
									<!-- /ko -->
								</div>
							</div>
							<!-- end inventory area -->

							<!-- start player combat area -->
							<div class="combat player" data-bind="if: currentEnemy(), css: { hidden: leftColContent() != 'combat_player' }">
								<div class="header">You</div>
								<div class="lines">
									
									<div class="line">
										<span class="stat">HP:</span>
										<span class="value hp" data-bind="animateNumbers: $root.player().hp()"></span>
									</div>
									<div class="line">
										<span class="stat">Speed:</span>
										<span class="value" data-bind="text: $root.player().speed()"></span>
									</div>
									
								</div>
							</div>
							<!-- end player combat area -->

						</div>

					</div>
					<!-- end leftcol -->

					<!-- start centercol -->
					<div class="col-md-4 centercol">

						<div class="centercol-inner">

							<!-- start map button area -->
							<div class="map-buttons" data-bind="css: { hidden: centerColContent() != 'map_controls' }">

								<div class="map-button-cluster">

									<h3>Swim Direction</h3>

									<button type="button" class="btn btn-default up" data-bind="click: $root.movePlayerUp">Upstream</button>
									<div class="mid-buttons">
										<button type="button" class="btn btn-default left" data-bind="click: $root.movePlayerLeft">Left</button>
										<button type="button" class="btn btn-default right" data-bind="click: $root.movePlayerRight">Right</button>
									</div>
									<button type="button" class="btn btn-default down" data-bind="click: $root.movePlayerDown">Downstream</button>
									<div class="arrow-keys-checkbox">
										<input type="checkbox" data-bind="checked: arrowKeysControlPlayerPos" />WASD keys control player movement
									</div>
								</div>
							</div>
							<!-- end map button area -->

							<!-- start inventory/equipment/merchant item description area -->
							<div class="item-desc" data-bind="css: { hidden: centerColContent() != 'item_desc' }">

								<button class="btn btn-default back" type="button" data-bind="click: showContentArea, css: { disabled: player().inventorySlotsOccupied() > player().inventoryMaxSlots() }"><span data-bind="text: backButtonLabel()"></span></button>

								<button class="btn btn-default take-all" type="button" data-bind="click: takeAllFromContainer, css: { hidden: rightColContent() != 'container' }"><span>Take All</span></button>

								<div class="clear"></div>

								<div class="inner" data-bind="css: { hidden: activeItem().desc() == '', equipped: activeItem().actualItem() && activeItem().actualItem().isEquipped() == true }">
									<div class="desc" data-bind="html: activeItem().desc()"></div>
									<!-- ko if: activeItem().actualItem() -->

										<!-- ko if: activeItem().actualItem().id != 'gold' -->
										<div class="line">
											<span class="stat" data-bind="text: activeItem().moveDirection() == 'left' && rightColContent() == 'merchant' ? 'Buy Value:' : 'Sell Value:' "></span>
											<span class="value" data-bind="text:
												activeItem().moveDirection() == 'left' &&
												rightColContent() == 'merchant' ?
													activeItem().actualItem().buyValue() + ' GP' :
													(activeItem().actualItem().sellValue() + ' GP' + (activeItem().actualItem().qty() > 1 ?
														' ea. (' + (activeItem().actualItem().qty() * activeItem().actualItem().sellValue()) + ' GP total)' :
														''))"></span>
										</div>
										<!-- /ko -->

										<!-- ko if: activeItem().actualItem().armorValue && typeof activeItem().actualItem().armorValue === 'function' -->
										<div class="line">
											<span class="stat">Armor Value:</span>
											<span class="value" data-bind="text: activeItem().actualItem().armorValue() + ( activeItem().actualItem().numUpgradesApplied() > 0 ? ' (Improved)' : '') "></span>
										</div>
										<!-- /ko -->

										<!-- ko if: activeItem().actualItem().dmgMin && typeof activeItem().actualItem().dmgMin === 'function' -->
										<div class="line">
											<span class="stat">DMG:</span>
											<span class="value" data-bind="text: activeItem().actualItem().dmgMin() + ' - ' + activeItem().actualItem().dmgMax() + ( activeItem().actualItem().numUpgradesApplied() > 0 ? ' (Improved)' : '')"></span>
										</div>
										<!-- /ko -->

										<!-- ko if: activeItem().actualItem().isEquippable && activeItem().canUnEquip() == 0 -->
										<div class="line">
											<span class="stat">If Equipped:</span>
											<span class="value" data-bind="html: getEquipChangeText()"></span>
										</div>
										<!-- /ko -->

										<!-- ko if: activeItem().canBuy() -->
										<div class="line">
											<span class="stat">Qty Available:</span>
											<span class="value" data-bind="text: activeItem().actualItem().qty()"></span>
										</div>
										<!-- /ko -->

										<!-- ko if: activeItem().actualItem().quality && typeof activeItem().actualItem().quality === 'function' -->
										<div class="line">
											<span class="stat">Quality:</span>
											<span class="value" data-bind="text: activeItem().actualItem().quality()"></span>
										</div>
										<!-- /ko -->

									<!-- /ko -->

									<!-- ko foreach: $root.activeItemButtons() -->
										<button class="btn inventory-control" data-bind="css: $data.css, click: $data.click, text: $data.text"></button>
									<!-- /ko -->
									
								</div>
							</div>
							<!-- end inventory/equipment/merchant item description area -->

							<!-- start combat button area -->
							<div class="combat combat-buttons" data-bind="if: currentEnemy(), css: { hidden: centerColContent() != 'combat_buttons' }">
								<div class="combat-buttons-inner">
									<div class="line">
										<button type="button" class="btn btn-default" data-bind="css: { hidden: $root.currentEnemy() == undefined || !$root.currentEnemy().isDead() }, click: $root.lootEnemy">Loot</button>
										<span class="button-label"></span>
									</div>
									<div class="line">
										<button type="button" class="btn btn-default" data-bind="css: { hidden: $root.currentEnemy() == undefined || !$root.currentEnemy().isDead() }, click: $root.leaveCombat">Leave</button>
										<span class="button-label"></span>
									</div>
									<!-- ko if: !$root.currentEnemy().isDead() && !$root.player().isDead() -->
									<div class="line">
										<button type="button" class="btn btn-default" data-bind="click: $root.playerAttacks">Attack!</button>
										<span class="button-label">Strike your enemy with your currently equipped weapon (if any)</span>
									</div>
									<!-- /ko -->
									<div class="line">
										<button type="button" class="btn btn-default" data-bind="css: { disabled: $root.player().numPotionsAvailable() < 1 || $root.player().isDead() }, click: $root.useHealthPotion, text: 'Use Health Potion (' + $root.player().numPotionsAvailable() + ')'">Use Health Potion</button>
										<span class="button-label">Consume a Health Potion (if any are in your inventory) and restore half your maximum HP</span>
									</div>
									<!-- ko if: !$root.currentEnemy().isDead() && !$root.player().isDead() -->
									<div class="line">
										<button type="button" class="btn btn-default" data-bind="click: $root.playerFlee">Flee!</button>
										<span class="button-label">Swim away as fast as you possibly can. (The monster will remain where it is)</span>
									</div>
									<!-- /ko -->
								</div>
							</div>
							<!-- end combat button area -->

							<!-- start fullscreen content area -->
							<div class="full-screen-row full-screen-notice" data-bind="with: fullScreenContent, css: { hidden: centerColContent() != 'fullscreen_content' }">

								<div class="notice-text">
									<div data-bind="html: text"></div>
								</div>
								<div class="notice-button">
									<div data-bind="foreach: buttons">
										<button type="button" class="btn btn-default" data-bind="click: $data.action, text: $data.title, css : ($data.css && typeof $data.css === 'function' ? $data.css() : '')"></button>
									</div>
								</div>

							</div>
							<!-- end fullscreen content area -->

						</div>

					</div>
					<!-- end centercol -->

					<!-- start rightcol -->
					<div class="col-md-4 rightcol">

						<div class="rightcol-inner">

							<!-- start map area -->
							<div class="map-container" data-bind="css: { hidden: rightColContent() != 'map' }">
								<div class="map-level-num">
									<h3 data-bind="text: 'Dungeon Level: ' + $root.level().levelNum()"></h3>
								</div>
								<div class="map">
									<canvas id="map-canvas" width="300" height="300"></canvas>
								</div>
								<div class="clear"></div>
							</div>
							<!-- end map area -->

							<!-- start equipment area -->
							<div class="equipment" data-bind="css: { hidden: rightColContent() != 'equipment' }" >

								<h3>Equipment</h3>

								<div class="equipment-inner-container">

									<!-- ko with: $root.player().equipment().armor().head() -->
										<div class="line" data-bind="click: function(){ $root.setEquipmentItemAsActiveItem( $data ) }, css: { selected: $root._shouldItemBeSelected($data), empty : $data.name == undefined }">
											<span class="slot">Head Armor:</span>
											<span class="item" data-bind="text: $data.name || 'None'"></span>
										</div>
									<!-- /ko -->

									<!-- ko with: $root.player().equipment().armor().fin() -->
										<div class="line" data-bind="click: function(){ $root.setEquipmentItemAsActiveItem( $data ) }, css: { selected: $root._shouldItemBeSelected($data), empty : $data.name == undefined }">
											<span class="slot">Fin Armor:</span>
											<span class="item" data-bind="text: $data.name || 'None'"></span>
										</div>
									<!-- /ko -->

									<!-- ko with: $root.player().equipment().armor().body() -->
										<div class="line" data-bind="click: function(){ $root.setEquipmentItemAsActiveItem( $data ) }, css: { selected: $root._shouldItemBeSelected($data), empty : $data.name == undefined }">
											<span class="slot">Body Armor:</span>
											<span class="item" data-bind="text: $data.name || 'None'"></span>
										</div>
									<!-- /ko -->

									<!-- ko with: $root.player().equipment().armor().tail() -->
										<div class="line" data-bind="click: function(){ $root.setEquipmentItemAsActiveItem( $data ) }, css: { selected: $root._shouldItemBeSelected($data), empty : $data.name == undefined }">
											<span class="slot">Tail Armor:</span>
											<span class="item" data-bind="text: $data.name || 'None'"></span>
										</div>
									<!-- /ko -->

									<!-- ko with: $root.player().equipment().weapon() -->
										<div class="line" data-bind="click: function(){ $root.setEquipmentItemAsActiveItem( $data ) }, css: { selected: $root._shouldItemBeSelected($data), empty : $data.name == undefined }">
											<span class="slot">Weapon:</span>
											<span class="item" data-bind="text: $data.name || 'None'"></span>
										</div>
									<!-- /ko -->

									<!-- ko with: $root.player().equipment().shield() -->
										<div class="line" data-bind="click: function(){ $root.setEquipmentItemAsActiveItem( $data ) }, css: { selected: $root._shouldItemBeSelected($data), empty : $data.name == undefined }">
											<span class="slot">Shield:</span>
											<span class="item" data-bind="text: $data.name || 'None'"></span>
										</div>
									<!-- /ko -->

								</div>

							</div>
							<!-- end equipment area -->

							<!-- start loot container area -->
							<div class="container-ui" data-bind="css: { hidden: rightColContent() != 'container' }" >

								<h3>Container</h3>

								<!-- ko if: $root.currentContainer.items().length == 0 -->
								<div class="line empty">
									<span class="item">The container is empty</span>
								</div>
								<!-- /ko -->

								<div class="container-ui-inner-container" data-bind="foreach: $root.currentContainer.items()">
									<div class="line" data-bind="click: $root.setContainerItemAsActiveItem, css: { selected: $root._shouldItemBeSelected($data) }">
										<span class="item" data-bind="text: $data.name"></span>
										<span class="qty" data-bind="text: $data.qty()"></span>
									</div>
								</div>

							</div>
							<!-- end loot container area -->

							<!-- start merchant area -->
							<div class="merchant" data-bind="css: { hidden: rightColContent() != 'merchant' }" >

								<h3>Merchant</h3>

								<!-- ko if: $root.currentContainer.items().length == 0 -->
								<div class="line empty">
									<span class="item">The merchant has no goods for sale</span>
								</div>
								<!-- /ko -->

								<div class="container-ui-inner-container" data-bind="foreach: $root.currentContainer.items()">
									<div class="line" data-bind="click: $root.setMerchantItemAsActiveItem, css: { selected: $root._shouldItemBeSelected($data) }">
										<span class="item" data-bind="text: $data.name"></span>
										<span class="qty" data-bind="text: $data.buyValue() + ' GP'"></span>
									</div>
								</div>

							</div>
							<!-- end merchant area -->

							<!-- start monster combat area -->
							<div class="combat enemy" data-bind="if: currentEnemy(), css: { hidden: rightColContent() != 'combat_enemy' }">
								<div class="header" data-bind="text: $root.currentEnemy().name()"></div>
								<div class="lines">
									
									<div class="line">
										<span class="stat">HP:</span>
										<span class="value hp" data-bind="animateNumbers: $root.currentEnemy().hp()"></span>
									</div>
									<div class="line">
										<span class="stat">Speed:</span>
										<span class="value" data-bind="text: $root.currentEnemy().speed()"></span>
									</div>
									
								</div>
								<div class="desc" data-bind="text: $root.currentEnemy().desc()"></div>
							</div>
							<!-- end monster combat area -->

						</div>

					</div>
					<!-- end rightcol -->

				</div>
				<!-- end main row -->

			</div>
			<!-- end main content area -->

			<!-- start message log area -->
			<div class="log-area hidden">
				<div class="row log-row">
					<div class="col-md-12">
						<div class="message-log" data-bind="foreach: logMessages()">
							<p data-bind="html: $data.text, css: $data.cssClass"></p>
						</div>
					</div>
				</div>
			</div>
			<!-- end message log area -->

			<input class="file-upload" type="file" name="Import Saved Game" id="importSavedGame" accept=".json" />
		</div><!-- /.container -->

		<!-- Bootstrap core JavaScript
		================================================== -->
		<!-- Placed at the end of the document so the pages load faster -->
		<script src="js/require.js" data-main="js/main"></script>
		<!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
		<!--<script src="js/ie10-viewport-bug-workaround.js"></script>-->
	</body>
</html>
